# Simple File Server Configuration

# Enable mod_rewrite for clean URLs
RewriteEngine On

# Remove .php extension from URLs
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^\.]+)$ $1.php [NC,L]

# Redirect .php URLs to clean URLs (optional - removes .php from address bar)
RewriteCond %{THE_REQUEST} \s/+(.+)\.php[\s?] [NC]
RewriteRule ^ /%1? [R=301,L]

# Enable directory listing
Options +Indexes
DirectoryIndex index.php index.html

# Hide sensitive files from listing
IndexIgnore .htaccess .htpasswd .DS_Store *.log *.conf *.ini

# Allow access to main PHP files
<Files "index.php">
    Require all granted
</Files>

<Files "upload.php">
    Require all granted
</Files>

# Security for sensitive files
<Files ".htaccess">
    Require all denied
</Files>

<Files ".htpasswd">
    Require all denied
</Files>

# Deny access to system files
<FilesMatch "\.(log|conf|ini|bak|backup)$">
    Require all denied
</FilesMatch>

# Force download for archives and documents
<FilesMatch "\.(zip|rar|7z|pdf|doc|docx|xls|xlsx|apk|exe|msi)$">
    Header set Content-Disposition "attachment"
    Header set Content-Type "application/octet-stream"
</FilesMatch>

# PHP upload settings
<IfModule mod_php.c>
    php_value upload_max_filesize 500M
    php_value post_max_size 500M
    php_value max_execution_time 600
    php_value memory_limit 256M
</IfModule>

# Additional security headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options nosniff
    Header always set X-Frame-Options DENY
    Header always set X-XSS-Protection "1; mode=block"
</IfModule>